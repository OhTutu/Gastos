<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Divisão de Despesas por Mês</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #121212;
      color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    /* ... restante do CSS igual ... */
  </style>
</head>
<body>
  <!-- ... estrutura HTML igual ... -->

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbwX4T7Gj6VTAWMZMlLvED3wAN0db6Hvqh-Ik1NKkqs1sxOhlS4qKnLn-zPW0vdNxAxJ/exec';
    const months = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
                    "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
    let currentMonth = new Date().getMonth();

    function flattenData(data) {
      const flat = [];
      ['aluguelList', 'cartaoList', 'extrasList'].forEach((listId, tipoIndex) => {
        data.sections[tipoIndex].forEach(item => {
          flat.push({
            mes: currentMonth,
            tipo: listId.replace('List', ''),
            nome: item.name,
            valor: item.value,
            pago: item.pago ? 'Sim' : 'Não',
            a: item.a ? 'Sim' : 'Não',
            r: item.r ? 'Sim' : 'Não'
          });
        });
      });
      flat.push({
        mes: currentMonth,
        tipo: 'ajuste',
        nome: 'Ajuste Manual',
        valor: '',
        pago: 'Sim',
        a: data.extraA,
        r: data.extraR
      });
      return flat;
    }

    function saveData() {
      const data = {
        extraA: document.getElementById('extraA').value,
        extraR: document.getElementById('extraR').value,
        sections: ['aluguelList', 'cartaoList', 'extrasList'].map(listId => {
          return Array.from(document.querySelectorAll(`#${listId} .item`)).map(item => {
            const inputs = item.querySelectorAll('input');
            return {
              pago: inputs[0].checked,
              name: inputs[1].value,
              value: inputs[2].value,
              a: inputs[3].checked,
              r: inputs[4].checked
            };
          });
        })
      };
      fetch(API_URL, {
        method: 'POST',
        body: JSON.stringify(flattenData(data)),
        headers: {
          'Content-Type': 'application/json'
        }
      }).then(() => {
        showSaveMessage();
      });
    }

    function loadData() {
      fetch(API_URL)
        .then(res => res.json())
        .then(rows => {
          const dados = rows.filter(row => row[0] !== 'Mes' && parseInt(row[0]) === currentMonth);
          const extraA = dados.find(r => r[1] === 'ajuste')?.[5] || 0;
          const extraR = dados.find(r => r[1] === 'ajuste')?.[6] || 0;
          document.getElementById('extraA').value = extraA;
          document.getElementById('extraR').value = extraR;
          const secoes = {
            aluguel: document.getElementById('aluguelList'),
            cartao: document.getElementById('cartaoList'),
            extras: document.getElementById('extrasList')
          };
          Object.values(secoes).forEach(sec => sec.innerHTML = '');
          dados.forEach(r => {
            if (r[1] === 'ajuste') return;
            const sec = secoes[r[1]];
            const item = createItem(r[2], r[3], r[5] === 'Sim', r[6] === 'Sim', r[4] === 'Sim');
            sec.appendChild(item);
          });
          calculateTotals();
        });
    }

    // ... restante das funções (createTabs, createItem, calculateTotals, etc.) igual ...

    createTabs();
    loadData();
  </script>
</body>
</html>
